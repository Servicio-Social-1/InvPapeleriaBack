"use strict";(self.webpackChunkgestionPapeleriaUI=self.webpackChunkgestionPapeleriaUI||[]).push([[590],{5590:(Y,a,s)=>{s.r(a),s.d(a,{PetitionersModule:()=>F});var l=s(6895),h=s(5642),u=s(529),p=s(82),c=s(3060),d=s(5238),t=s(4650),m=s(3589),S=s(7533),b=s(2680),g=s(5134),v=s(6228),f=s(7881),P=s(7791),x=s(5609),C=s(4859);function T(i,n){if(1&i&&t._UZ(0,"app-table",4),2&i){const e=t.oxw();t.Q6J("dataToDisplay",e.petitioners)("displayedColumns",e.columns)("errorMsg",e.errorMsg)}}function y(i,n){if(1&i&&t._UZ(0,"app-table",4),2&i){const e=t.oxw();t.Q6J("dataToDisplay",e.petitionersFromSearch)("displayedColumns",e.columns)("errorMsg",e.errorMsg)}}const M=[{path:"",component:(()=>{class i{constructor(e,o,r,A,J,O){this.dialogService=e,this.petitionersService=o,this.petitionersStore=r,this.loadingService=A,this.searchStoreService=J,this.tableStoreService=O,this.petitionerCount=1,this.limitAndOffsetAndSize={limit:25,offset:0},this.isSearching=!1,this.columns=[]}ngOnInit(){this.loadingService.toggleLoading(!0),this.tableStoreService.setTableContext("petitioner"),this.deletePetitionerSubs=this.tableStoreService.rowToRemove$.subscribe(e=>{if(!this.petitioners.length)return;const o=this.petitioners.findIndex(r=>r.id===e?.id);this.petitioners.splice(o,1),this.petitioners=[...this.petitioners]}),this.newPetitionerSubs=this.petitionersStore.newPetitioner$.subscribe(e=>{e.options=["edit","delete"],this.petitioners.push({options:["edit","delete"],...e}),this.petitioners=[...this.petitioners]}),this.updatedPetitionerSubs=this.petitionersStore.updatedPetitioner$.subscribe(e=>{const o=this.petitioners.findIndex(r=>r.id===e.id);this.petitioners[o]={options:["edit","delete"],...e},this.petitioners=[...this.petitioners]}),this.loadingSubs=this.loadingService.isLoading$.subscribe(e=>{this.isLoading=e}),this.petitionersSubs=this.petitionersService.getPetitioners().subscribe({next:e=>this.setTableData(e),error:e=>this.setTableErrorData(e)}),this.valueSearchSubs=this.searchStoreService.value$.subscribe(this.handleValueSearchSubs),this.itemsFromSearchSubs=this.searchStoreService.itemsFromSearch$.subscribe(this.handleItemsFromSearch)}handleItemsFromSearch(e){this.petitionersFromSearch=e.map(o=>(o.options=["edit","delete"],o))}handleValueSearchSubs(e){return this.isSearching=!!e}getpetitioners(){return this.petitionersService.getPetitioners().subscribe({error:e=>this.setTableErrorData(e),next:e=>this.setTableData(e)})}setTableErrorData(e){this.columns=["id","name","area","options"],this.petitioners=[],this.errorMsg=e.error.message,this.loadingService.toggleLoading(!1)}setTableData(e){this.columns=["id","name","area","options"];const o=e.map(r=>({area:r.area?.name,id:r.id,name:r.name,status:r.status,options:["edit","delete"]}));this.petitioners=[...o],this.petitionersStore.updateDisplayedPetitioners(this.petitioners),this.loadingService.toggleLoading(!1)}openDialog(){this.searchStoreService.updateItems([]),this.itemsFromSearchSubs?.unsubscribe(),this.valueSearchSubs?.unsubscribe(),this.dialogService.openDialog({component:d.G,callback:()=>{this.tableStoreService.setTableContext("petitioner"),this.itemsFromSearchSubs=this.searchStoreService.itemsFromSearch$.subscribe(this.handleItemsFromSearch),this.valueSearchSubs=this.searchStoreService.value$.subscribe(this.handleValueSearchSubs)},data:{title:"Nuevo Solicitante"}})}ngOnDestroy(){this.newpetitionerFormIsOpenSubs?.unsubscribe(),this.petitionersSubs?.unsubscribe(),this.valueSearchSubs?.unsubscribe(),this.loadingSubs?.unsubscribe(),this.updatedPetitionerSubs?.unsubscribe(),this.newPetitionerSubs?.unsubscribe(),this.petitionerStatusSubs?.unsubscribe(),this.deletePetitionerSubs?.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.x),t.Y36(S.t),t.Y36(b.r),t.Y36(g.b),t.Y36(v.y),t.Y36(f.B))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-petitioners"]],decls:8,vars:3,consts:[[3,"context"],["mat-raised-button","","color","primary",1,"button",3,"click"],[3,"dataToDisplay","displayedColumns","errorMsg",4,"ngIf","ngIfElse"],["searchTable",""],[3,"dataToDisplay","displayedColumns","errorMsg"]],template:function(e,o){if(1&e&&(t.TgZ(0,"h1"),t._uU(1,"Solicitantes"),t.qZA(),t.TgZ(2,"app-search",0)(3,"button",1),t.NdJ("click",function(){return o.openDialog()}),t._uU(4,"Agregar solicitante"),t.qZA()(),t.YNc(5,T,1,3,"app-table",2),t.YNc(6,y,1,3,"ng-template",null,3,t.W1O)),2&e){const r=t.MAs(7);t.xp6(2),t.Q6J("context","areas"),t.xp6(3),t.Q6J("ngIf",!o.isSearching)("ngIfElse",r)}},dependencies:[l.O5,P.g,x.a,C.lW],styles:["h1[_ngcontent-%COMP%]{margin:20px}.button[_ngcontent-%COMP%]{max-height:50px!important}"]}),i})()}];let I=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[c.Bz.forChild(M),c.Bz]}),i})();var D=s(4006);let F=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[l.ez,h.K,u.JF,p.q,I,D.UX]}),i})()}}]);