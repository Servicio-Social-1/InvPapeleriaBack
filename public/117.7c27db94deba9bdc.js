"use strict";(self.webpackChunkgestionPapeleriaUI=self.webpackChunkgestionPapeleriaUI||[]).push([[117],{1117:($,n,a)=>{a.r(n),a.d(n,{AreasModule:()=>F});var l=a(6895),c=a(5642),u=a(529),d=a(82),h=a(3060),S=a(5098),s=a(4650),m=a(3589),b=a(8259),g=a(798),p=a(5134),v=a(6228),A=a(7881),f=a(7791),C=a(5609),x=a(4859);function T(t,o){if(1&t&&s._UZ(0,"app-table",4),2&t){const e=s.oxw();s.Q6J("dataToDisplay",e.areas)("displayedColumns",e.columns)("errorMsg",e.errorMsg)}}function y(t,o){if(1&t&&s._UZ(0,"app-table",4),2&t){const e=s.oxw();s.Q6J("dataToDisplay",e.areasFromSearch)("displayedColumns",e.columns)("errorMsg",e.errorMsg)}}const M=[{path:"",component:(()=>{class t{constructor(e,r,i,J,O,Y){this.dialogService=e,this.areasService=r,this.areasStore=i,this.loadingService=J,this.searchStoreService=O,this.tableStoreService=Y,this.areaCount=1,this.limitAndOffsetAndSize={limit:25,offset:0},this.isSearching=!1,this.columns=[]}ngOnInit(){this.loadingService.toggleLoading(!0),this.tableStoreService.setTableContext("area"),this.deleteAreaSubs=this.tableStoreService.rowToRemove$.subscribe(e=>{if(!this.areas.length)return;const r=this.areas.findIndex(i=>i.id===e?.id);this.areas.splice(r,1),this.areas=[...this.areas]}),this.newAreaSubs=this.areasStore.newArea$.subscribe(e=>{e.options=["edit","delete"],this.areas.push(e),this.areas=[...this.areas]}),this.updatedAreaSubs=this.areasStore.updatedArea$.subscribe(e=>{const r=this.areas.findIndex(i=>i.id===e.id);this.areas[r]=e,this.areas=[...this.areas]}),this.loadingSubs=this.loadingService.isLoading$.subscribe(e=>{this.isLoading=e}),this.areasSubs=this.areasService.getAreas().subscribe({next:e=>this.setTableData(e),error:e=>this.setTableErrorData(e)}),this.valueSearchSubs=this.searchStoreService.value$.subscribe(this.handleValueSearchSubs),this.itemsFromSearchSubs=this.searchStoreService.itemsFromSearch$.subscribe(this.handleItemsFromSearch)}handleItemsFromSearch(e){this.areasFromSearch=e.map(r=>(r.options=["edit","delete"],r))}handleValueSearchSubs(e){return this.isSearching=!!e}getAreas(){return this.areasService.getAreas().subscribe({error:e=>this.setTableErrorData(e),next:e=>this.setTableData(e)})}setTableErrorData(e){this.columns=["id","name","options"],this.areas=[],this.errorMsg=e.error.message,this.loadingService.toggleLoading(!1)}setTableData(e){this.columns=["id","name","options"];const r=e.map(i=>({options:["edit","delete"],...i}));this.areas=[...r],this.areasStore.updateDisplayedAreas(this.areas),this.loadingService.toggleLoading(!1)}openDialog(){this.searchStoreService.updateItems([]),this.itemsFromSearchSubs?.unsubscribe(),this.valueSearchSubs?.unsubscribe(),this.dialogService.openDialog({component:S.W,callback:()=>{this.tableStoreService.setTableContext("area"),this.itemsFromSearchSubs=this.searchStoreService.itemsFromSearch$.subscribe(this.handleItemsFromSearch),this.valueSearchSubs=this.searchStoreService.value$.subscribe(this.handleValueSearchSubs)},data:{title:"Nueva \xe1rea"}})}ngOnDestroy(){this.newAreaFormIsOpenSubs?.unsubscribe(),this.areasSubs?.unsubscribe(),this.valueSearchSubs?.unsubscribe(),this.loadingSubs?.unsubscribe(),this.updatedAreaSubs?.unsubscribe(),this.newAreaSubs?.unsubscribe(),this.areaStatusSubs?.unsubscribe(),this.deleteAreaSubs?.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(m.x),s.Y36(b.E),s.Y36(g.v),s.Y36(p.b),s.Y36(v.y),s.Y36(A.B))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-areas"]],decls:8,vars:3,consts:[[3,"context"],["mat-raised-button","","color","primary",1,"button",3,"click"],[3,"dataToDisplay","displayedColumns","errorMsg",4,"ngIf","ngIfElse"],["searchTable",""],[3,"dataToDisplay","displayedColumns","errorMsg"]],template:function(e,r){if(1&e&&(s.TgZ(0,"h1"),s._uU(1,"\xc1reas"),s.qZA(),s.TgZ(2,"app-search",0)(3,"button",1),s.NdJ("click",function(){return r.openDialog()}),s._uU(4,"Agregar nueva \xe1rea"),s.qZA()(),s.YNc(5,T,1,3,"app-table",2),s.YNc(6,y,1,3,"ng-template",null,3,s.W1O)),2&e){const i=s.MAs(7);s.xp6(2),s.Q6J("context","areas"),s.xp6(3),s.Q6J("ngIf",!r.isSearching)("ngIfElse",i)}},dependencies:[l.O5,f.g,C.a,x.lW],styles:["h1[_ngcontent-%COMP%]{margin:20px}.button[_ngcontent-%COMP%]{max-height:50px!important}"]}),t})()}];let I=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[h.Bz.forChild(M),h.Bz]}),t})();var D=a(4006);let F=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[l.ez,c.K,u.JF,d.q,I,D.UX]}),t})()}}]);