"use strict";(self.webpackChunkgestionPapeleriaUI=self.webpackChunkgestionPapeleriaUI||[]).push([[565],{6565:(p,d,t)=>{t.r(d),t.d(d,{AuthModule:()=>R});var c=t(6895),o=t(3060),a=t(4006),i=t(3713),e=t(4650),m=t(4060),s=t(4159),h=t(1928),_=t(8128),n=t(3589),S=t(7392),v=t(4859),M=t(9549),r=t(4144),u=t(3546);const O=[{path:"",component:(()=>{class l{constructor(g,f,D,b,x,U,A){this.fb=g,this.emailValidator=f,this.authService=D,this.localStorageService=b,this.router=x,this.dialogMessageService=U,this.dialogService=A,this.loginForm=this.fb.group({email:["",[a.kI.required,a.kI.pattern(this.emailValidator.emailPattern)],[this.emailValidator]],password:["",[a.kI.required,a.kI.minLength(6)]]})}ngOnInit(){}get emailErrorMsg(){const g=this.loginForm.get("email")?.errors;return g?.required?"Email es obligatorio":g?.pattern?"El texto ingresado no tiene formato de email":""}submit(){this.loginForm.markAllAsTouched(),this.loginForm.valid&&this.authService.login(this.loginForm.value).subscribe({next:g=>{this.dialogMessageService.setMessage("Credenciales correctas, iniciando sesi\xf3n"),this.dialogService.openDialog({component:i.P}),this.setSession(g)},error:g=>(this.dialogMessageService.setMessage(g.error.message),this.dialogService.openDialog({component:i.P}))})}setSession({email:g,id:f,role:D,token:b}){this.localStorageService.setItem({key:"user",value:{email:g,id:f,role:D}}),this.localStorageService.setItem({key:"token",value:b}),this.router.navigate(["user","inventory"])}}return l.\u0275fac=function(g){return new(g||l)(e.Y36(a.qu),e.Y36(m.e),e.Y36(s.e),e.Y36(h.n),e.Y36(o.F0),e.Y36(_.z),e.Y36(n.x))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-login"]],decls:28,vars:3,consts:[[1,"login-page","login-bg"],[1,"mat-elevation-z12"],[2,"text-align","center"],[3,"formGroup","ngSubmit"],["matInput","","type","email","placeholder","Correo","formControlName","email"],["matSuffix",""],["matInput","","type","password","placeholder","Contrase\xf1a","formControlName","password"],["mat-raised-button","","color","primary","type","submit",1,"login-button",3,"disabled"]],template:function(g,f){1&g&&(e.TgZ(0,"div",0)(1,"mat-card",1)(2,"mat-card-title",2),e._uU(3,"Iniciar sesi\xf3n"),e.qZA(),e.TgZ(4,"mat-card-content")(5,"form",3),e.NdJ("ngSubmit",function(){return f.submit()}),e.TgZ(6,"mat-form-field"),e._UZ(7,"input",4),e.TgZ(8,"mat-error"),e._uU(9),e.qZA(),e.TgZ(10,"mat-icon",5),e._uU(11,"email"),e.qZA()(),e.TgZ(12,"mat-form-field"),e._UZ(13,"input",6),e.TgZ(14,"mat-error"),e._uU(15," La "),e.TgZ(16,"strong"),e._uU(17,"contrase\xf1a"),e.qZA(),e._uU(18," es requerida "),e.qZA(),e.TgZ(19,"mat-error"),e._uU(20," La "),e.TgZ(21,"strong"),e._uU(22,"contrase\xf1a"),e.qZA(),e._uU(23," debe de ser mayor a 6 caracteres "),e.qZA(),e.TgZ(24,"mat-icon",5),e._uU(25,"lock"),e.qZA()(),e.TgZ(26,"button",7),e._uU(27," Sign In "),e.qZA()()()()()),2&g&&(e.xp6(5),e.Q6J("formGroup",f.loginForm),e.xp6(4),e.hij(" ",f.emailErrorMsg," "),e.xp6(17),e.Q6J("disabled",f.loginForm.pending))},dependencies:[S.Hw,v.lW,M.TO,M.KE,M.R9,r.Nt,u.a8,u.dn,u.n5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u],styles:[".login-page[_ngcontent-%COMP%]{top:0;margin:0;padding:0;width:100%;height:100%;display:block;overflow:hidden}mat-card[_ngcontent-%COMP%]{width:50%;margin:10% auto;border-radius:8px}mat-form-field[_ngcontent-%COMP%], mat-checkbox[_ngcontent-%COMP%]{width:80%;display:block;margin:auto}mat-card-content[_ngcontent-%COMP%]{margin-top:20px}.login-button[_ngcontent-%COMP%]{display:block;width:80%;margin:20px auto}mat-grid-tile[_ngcontent-%COMP%]{background:lightblue}"]}),l})()}];let P=(()=>{class l{}return l.\u0275fac=function(g){return new(g||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[o.Bz.forChild(O),o.Bz]}),l})();var T=t(82);let R=(()=>{class l{}return l.\u0275fac=function(g){return new(g||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[c.ez,P,T.q,a.UX]}),l})()},4159:(p,d,t)=>{t.d(d,{e:()=>s});var c=t(2340),o=t(262),a=t(9646),i=t(4004),e=t(4650),m=t(529);let s=(()=>{class h{constructor(n){this.http=n,this.baseUrl=c.N.baseUrl}login(n){return this.http.post(`${this.baseUrl}/auth/login`,n)}register(n){return this.http.post(`${this.baseUrl}/auth/register`,n)}userStatus(){return this.http.get(`${this.baseUrl}/auth/check-user-status`).pipe((0,o.K)(n=>(0,a.of)(!1)),(0,i.U)(n=>!!n))}adminStatus(){return this.http.get(`${this.baseUrl}/auth/check-admin-status`).pipe((0,o.K)(n=>(0,a.of)(!1)),(0,i.U)(n=>!!n))}loggedIn(n){return this.http.post(`${this.baseUrl}/auth/logged-in`,{token:n})}}return h.\u0275fac=function(n){return new(n||h)(e.LFG(m.eN))},h.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},3589:(p,d,t)=>{t.d(d,{x:()=>a});var c=t(4650),o=t(5412);let a=(()=>{class i{constructor(m){this.dialog=m}openDialog({component:m,callback:s,data:h,sizes:_}){this.dialog.open(m,{maxHeight:"600px",minWidth:_?.minWidth?_?.minWidth:void 0,data:h}).afterClosed().subscribe(S=>{s&&s()})}closeDialog(){this.dialog.closeAll()}}return i.\u0275fac=function(m){return new(m||i)(c.LFG(o.uw))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()},7881:(p,d,t)=>{t.d(d,{B:()=>i});var c=t(1135),o=t(7579),a=t(4650);let i=(()=>{class e{constructor(){this.tableRows=new c.X(0),this.tableRows$=this.tableRows.asObservable(),this.tableColumns=new c.X([]),this.tableColumns$=this.tableColumns.asObservable(),this.tableContext=new c.X("departure-ticket"),this.tableContext$=this.tableContext.asObservable(),this.selectedRow=new c.X(null),this.selectedRow$=this.selectedRow.asObservable(),this.rowToRemove=new o.x,this.rowToRemove$=this.rowToRemove.asObservable(),this.listenRowToRemove=new o.x,this.listenRowToRemove$=this.listenRowToRemove.asObservable()}setTableContext(s){this.tableContext.next(s)}setSelectedRow(s){this.selectedRow.next(s)}removeSelectedRow(s){this.rowToRemove.next(s)}setTableRows(s){this.tableRows.next(s)}setTableColumns(s){this.tableColumns.next(s)}toggleListenRowToRemove(s){this.listenRowToRemove.next(s)}}return e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},3713:(p,d,t)=>{t.d(d,{P:()=>S});var c=t(5412),o=t(4650),a=t(8128),i=t(3589),e=t(3060),m=t(1928),s=t(7881),h=t(6895),_=t(4859);function n(v,M){if(1&v){const r=o.EpF();o.ynx(0),o.TgZ(1,"div",1)(2,"button",2),o.NdJ("click",function(){o.CHM(r);const E=o.oxw();return o.KtG(E.confirm(!0))}),o._uU(3,"S\xed"),o.qZA(),o._UZ(4,"span",3),o.TgZ(5,"button",4),o.NdJ("click",function(){o.CHM(r);const E=o.oxw();return o.KtG(E.confirm(!1))}),o._uU(6,"No"),o.qZA()(),o.BQk()}}let S=(()=>{class v{constructor(r,u,E,O,P,T){this.data=r,this.dialogMessageService=u,this.dialogService=E,this.router=O,this.localStorageService=P,this.tableStoreService=T,this.message=""}ngOnInit(){this.messageSubs=this.dialogMessageService.message$.subscribe(r=>{this.message=r}),this.messageContextSubs=this.dialogMessageService.messageContext$.subscribe(r=>{this.messageContext=r})}ngOnDestroy(){this.messageSubs?.unsubscribe(),this.messageContextSubs.unsubscribe()}confirm(r){if(!r)return this.dialogService.closeDialog();const u={confirmDeleteDepartureTicket:()=>{this.dialogMessageService.toggleConfirmMessage(r),this.tableStoreService.removeSelectedRow(this.data.departureTicket)},confirmDeleteArticle:()=>{this.dialogMessageService.toggleConfirmMessage(r),this.tableStoreService.removeSelectedRow(this.data.departureTicket)},confirmDeleteUser:()=>{this.dialogMessageService.toggleConfirmMessage(r),this.tableStoreService.removeSelectedRow(this.data.user)},confirmDeleteArea:()=>{this.dialogMessageService.toggleConfirmMessage(r),this.tableStoreService.removeSelectedRow(this.data.area)},confirmDeletePetitioner:()=>{this.dialogMessageService.toggleConfirmMessage(r),this.tableStoreService.removeSelectedRow(this.data.area)},logout:()=>{this.dialogService.closeDialog(),this.localStorageService.removeItem("token"),this.localStorageService.removeItem("user"),this.router.navigateByUrl("/auth")},default:()=>{}};return u[this.messageContext]?u[this.messageContext]():u.default()}}return v.\u0275fac=function(r){return new(r||v)(o.Y36(c.WI),o.Y36(a.z),o.Y36(i.x),o.Y36(e.F0),o.Y36(m.n),o.Y36(s.B))},v.\u0275cmp=o.Xpm({type:v,selectors:[["app-dialog-message"]],decls:3,vars:2,consts:[[4,"ngIf"],[1,"flex"],["mat-raised-button","","color","warn",3,"click"],[1,"spacer"],["mat-raised-button","","color","primary",3,"click"]],template:function(r,u){1&r&&(o.TgZ(0,"p"),o._uU(1),o.qZA(),o.YNc(2,n,7,0,"ng-container",0)),2&r&&(o.xp6(1),o.Oqu(u.message),o.xp6(1),o.Q6J("ngIf",null==u.data?null:u.data.isConfirmMessage))},dependencies:[h.O5,_.lW],styles:[".flex[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"]}),v})()},8128:(p,d,t)=>{t.d(d,{z:()=>i});var c=t(1135),o=t(7579),a=t(4650);let i=(()=>{class e{constructor(){this.message=new c.X(""),this.message$=this.message.asObservable(),this.confirmMessage=new o.x,this.confirmMessage$=this.confirmMessage.asObservable(),this.messageContext=new c.X("confirmDeleteArticle"),this.messageContext$=this.messageContext.asObservable()}setMessage(s){this.message.next(s)}toggleConfirmMessage(s){this.confirmMessage.next(s)}setMessageContext(s){this.messageContext.next(s)}}return e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},4060:(p,d,t)=>{t.d(d,{e:()=>i});var c=t(9646),o=t(4650),a=t(529);let i=(()=>{class e{constructor(s){this.http=s,this.emailPattern=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i}validate(s){return(0,c.of)(null)}}return e.\u0275fac=function(s){return new(s||e)(o.LFG(a.eN))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);